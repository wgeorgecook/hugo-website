<!doctype html><html lang=en><head><title>Javascript_truthiness :: William George Cook</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Javascript's Weakness Is It's Biggest Strength"><meta name=keywords content="javascript,comparisons,equality,types"><meta name=robots content="noodp"><link rel=canonical href=https://williamgeorgecook.com/posts/javascript_truthiness/><link rel=stylesheet href=https://williamgeorgecook.com/assets/style.css><link rel=stylesheet href=https://williamgeorgecook.com/assets/pink.css><link rel=apple-touch-icon href=https://williamgeorgecook.com/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://williamgeorgecook.com/img/favicon/pink.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Javascript_truthiness"><meta property="og:description" content="Javascript's Weakness Is It's Biggest Strength"><meta property="og:url" content="https://williamgeorgecook.com/posts/javascript_truthiness/"><meta property="og:site_name" content="William George Cook"><meta property="og:image" content="https://williamgeorgecook.com/img/favicon/pink.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2022-09-23 10:21:08 -0700 -0700"></head><body class=pink><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>William George Cook</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/>About</a></li><li><a href=/contact>Contact</a></li><li><a href=/posts>Posts</a></li><li><a href=/showcase>Public Projects</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/>About</a></li><li><a href=/contact>Contact</a></li><li><a href=/posts>Posts</a></li><li><a href=/showcase>Public Projects</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://williamgeorgecook.com/posts/javascript_truthiness/>Javascript_truthiness</a></h1><div class=post-meta><span class=post-date>2022-09-23</span>
<span class=post-author>:: William George Cook</span></div><span class=post-tags>#<a href=https://williamgeorgecook.com/tags/javascript/>javascript</a>&nbsp;
#<a href=https://williamgeorgecook.com/tags/bugs/>bugs</a>&nbsp;
#<a href=https://williamgeorgecook.com/tags/work/>work</a>&nbsp;</span><div class=post-content><div><h2 id=comparisons-in-javascript>Comparisons in Javascript<a href=#comparisons-in-javascript class=hanchor arialabel=Anchor>&#8983;</a></h2><p>While my title may say &ldquo;Full Stack&rdquo;, I&rsquo;m really a backend dev who is pretty flexible and willing to hack around the front end when necessary. This can sometimes lead to me falling for some Javascript gotchas (see also [Python None]https://williamgeorgecook.com/posts/python_none/). This week in Adventures With Javascript, I got to scratch my head on a bug where a form was falling back to a default value even when a valid input was entered.</p><h3 id=a-flexible-type-system>A Flexible Type System<a href=#a-flexible-type-system class=hanchor arialabel=Anchor>&#8983;</a></h3><p>One of Javascripts biggest flaws is actually one of it&rsquo;s biggest strengths. Since Javascript does not require strict typing, it&rsquo;s able to compare two different types and Javascript will do it&rsquo;s best to coerce them to a shared type. For instance, you can compare strings and integers:</p><pre tabindex=0><code>const a = 1;
const b = &#39;1&#39;;
console.log(a == b);

&gt; true
</code></pre><p>You can compare strings and booleans:</p><pre tabindex=0><code>const a = false;
const b = &#39;&#39;;
console.log(a == b);

&gt; true
</code></pre><p>This flexibility makes it a lot less daunting for new developers. And if you&rsquo;re designing and api but haven&rsquo;t settled on a schema for the data,this system makes prototyping very rapid. However, there can be unintended drawbacks.</p><h3 id=type-coercion>Type Coercion<a href=#type-coercion class=hanchor arialabel=Anchor>&#8983;</a></h3><p>You&rsquo;ll notice in the second example above that an empty string is coerced to a falsy boolean. The same thing happens with the number 0.</p><pre tabindex=0><code>const a = false;
const b = 0;
console.log(a == b);

&gt; true
</code></pre><p>Which can cause some issues if you&rsquo;re doing some form validation where 0 is either a valid input, or the user provided input is transformed to 0 for the backend to process. In this example I was coercing a 12 hour AM/PM based user input into a 24 hour based number to send to the backend.</p><pre tabindex=0><code>const twelveToTwentyFour = (timeInt, amOrPm) =&gt; {
    if (amOrPm == &#39;PM&#39;) {
      // Add 12 to the provided timeInt but don&#39;t send 12 PM as 24
      return (timeInt === 12) ? 12 : timeInt + 12;
    } else {
      // Ensure we don&#39;t send 12 AM as 12
      return (timeInt === 12) ? 0 : timeInt;
    }
}
</code></pre><h3 id=bug-hunting>Bug Hunting<a href=#bug-hunting class=hanchor arialabel=Anchor>&#8983;</a></h3><p>If the user passes in 12AM to this function, we transform it to 0 before we send it to the backend. However, this caused issues when we try to validate the form and fill in default values.</p><pre tabindex=0><code> const start = twelveToTwentyFour(12, &#39;AM&#39;) || 8;
 console.log(start);

 &gt; 8
</code></pre><p>12AM is a valid time, so why are we getting the default value set on the form? Type coercion comes to help in here because we&rsquo;re doing the <code>or</code> operation here to validate the input.</p><pre tabindex=0><code>const a = 0;
const b = 8;
console.log(a || b);

&gt; 8
</code></pre><p>You can verify that 0 here is being interpreted as a falsy value but comparing against a falsy boolean:</p><pre tabindex=0><code>const a = 0;
const b = false;
console.log(a == b);

&gt; true
</code></pre><h3 id=bug-squishing>Bug Squishing<a href=#bug-squishing class=hanchor arialabel=Anchor>&#8983;</a></h3><p>So here we are! We identified the bug. But how do we fix it? Luckily, Javascript has a way to do <em>strict</em> type checking. Substitute that double equals (<code>==</code>) for a triple equals (<code>===</code>) and you&rsquo;ll get more expected results.</p><pre tabindex=0><code>const a = 0;
const b = false;
console.log(a === b);

&gt; false
</code></pre><p>We need to change our original valiation a little. Prior to user input, our start value is <code>undefined</code>. Using a strict equality check on <code>undefined</code> we can determine if we need to set this to the user provided input, or default it to 8.</p><pre tabindex=0><code>const parsed = twelveToTwentyFour(12, &#39;AM&#39;)
const start = (parsed === undefined) ? 8 : parsed;
console.log(start);

&gt; 0
</code></pre><p>Calling the function without any arguments validates this for us.</p><pre tabindex=0><code>const parsed = twelveToTwentyFour()
const start = (parsed === undefined) ? 8 : parsed;
console.log(start);

&gt; 8
</code></pre><h2 id=how-many-equals>How Many Equals?<a href=#how-many-equals class=hanchor arialabel=Anchor>&#8983;</a></h2><p>If you&rsquo;re like me and used to programming in strictly typed systems, some Javascript niceties like the triple equals can slip your mind. Sometimes you&rsquo;re dealing with component libraries and the return values from those components don&rsquo;t match what your API require. However, unless you have a really good reason to use a loose comparison, use the strict equals operator and avoid spending half a day dealing with problems like this. If you want to explore how the loose equality operator handles these type comparisons, <a href=https://dorey.github.io/JavaScript-Equality-Table/>this table</a> shows exactly what comparisons are truthy and which are not.</p></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>William George Cook 2022</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://williamgeorgecook.com/assets/main.js></script>
<script src=https://williamgeorgecook.com/assets/prism.js></script></div></body></html>